# Client Management Application - AWS Infrastructure

A production-ready Terraform infrastructure project that deploys a scalable Flask web application with MySQL database on AWS.

## Architecture Overview

This project provisions the following AWS infrastructure:

- **VPC**: Multi-AZ VPC with public, private, and database subnets
- **RDS MySQL**: Managed database in private subnets
- **Auto Scaling Group**: EC2 instances running Flask application
- **Application Load Balancer**: HTTPS-enabled ALB with SSL certificate
- **S3 Bucket**: Stores application scripts and assets
- **Lambda Function**: Automated database permission management
- **Secrets Manager**: Secure storage of database credentials
- **Route53**: DNS configuration with SSL certificate

## Project Structure

```
app_db/
├── README.md                    # Project documentation
├── .gitignore                   # Git ignore rules
├── provider.tf                  # Provider configuration
├── variables.tf                 # Input variables
├── outputs.tf                   # Output values
├── locals.tf                    # Local values
│
├── vpc.tf                       # VPC and networking
├── security-groups.tf           # Security groups
├── database.tf                  # RDS database
├── autoscaling.tf               # Auto Scaling Group
├── loadbalancer.tf              # Application Load Balancer
├── s3.tf                        # S3 bucket for scripts
├── iam.tf                       # IAM roles and policies
├── secrets.tf                   # Secrets Manager
├── lambda.tf                    # Lambda function
├── route53.tf                   # DNS configuration
├── ssl.tf                       # SSL certificates
│
├── scripts/                     # Application scripts
│   ├── userdata_bootstrap.sh
│   └── userdata_client_app.sh
│
└── lambda/                      # Lambda function code
    └── grant_permissions.py
```

## Prerequisites

- Terraform >= 1.0
- AWS CLI configured with appropriate credentials
- AWS account with necessary permissions
- Domain name for Route53 (optional)

## Quick Start

### 1. Clone and Initialize

```bash
git clone <repository-url>
cd app_db
terraform init
```

### 2. Configure Variables

Create `terraform.tfvars`:

```hcl
region          = "us-east-1"
environment     = "dev"
name_prefix     = "web-app"
db_username     = "admin"
db_password     = "your-secure-password"
hosted_zone_name = "example.com"
```

### 3. Deploy Infrastructure

```bash
terraform plan
terraform apply
```

### 4. Access Application

After deployment, access the application via the load balancer DNS name or Route53 domain.

## Key Features

- ✅ **Scalable**: Auto Scaling Group with health checks
- ✅ **Secure**: Database in private subnets, secrets in Secrets Manager
- ✅ **Highly Available**: Multi-AZ deployment
- ✅ **Automated**: Lambda function manages database permissions
- ✅ **SSL/TLS**: HTTPS enabled with ACM certificate
- ✅ **Cost Optimized**: Single NAT Gateway, appropriate instance sizes

## Infrastructure Components

### Networking
- VPC with public, private, and database subnets
- NAT Gateway for outbound internet access
- Security groups for network isolation

### Compute
- Auto Scaling Group (2-4 EC2 instances)
- Launch Template with userdata scripts
- Application deployed via S3-stored scripts

### Database
- RDS MySQL 8.4 in private subnets
- Automated backups and encryption
- Lambda function for permission management

### Load Balancing
- Application Load Balancer with HTTPS
- Health checks on `/health` endpoint
- SSL certificate via ACM

### Security
- IAM roles with least privilege
- Secrets Manager for credentials
- Security groups restricting access
- Encrypted storage and backups

## Variables

See `variables.tf` for all available variables. Key variables:

- `region`: AWS region (default: us-east-1)
- `environment`: Environment name (default: dev)
- `name_prefix`: Resource name prefix
- `db_username`: Database username
- `db_password`: Database password
- `instance_type`: EC2 instance type (default: t3.medium)
- `db_instance_type`: RDS instance type (default: db.t3.micro)

## Outputs

See `outputs.tf` for all outputs. Key outputs:

- `load_balancer_dns`: DNS name of the load balancer
- `database_endpoint`: RDS database endpoint
- `s3_bucket_app_assets`: S3 bucket name for scripts

## Maintenance

### Update Application

1. Modify `scripts/userdata_client_app.sh`
2. Run `terraform apply`
3. Instance refresh will automatically trigger

### Scale Infrastructure

Modify variables and apply:

```hcl
desired_capacity = 4
max_size        = 8
```

## Cleanup

To destroy all resources:

```bash
terraform destroy
```

⚠️ **Warning**: This will delete all infrastructure including the database and its backups.

## Best Practices Implemented

- ✅ Infrastructure as Code
- ✅ Modular design
- ✅ State management (S3 backend)
- ✅ Secure credential storage
- ✅ Automated backups
- ✅ Health checks and monitoring
- ✅ Cost optimization
- ✅ Security best practices

## License

[Your License Here]

## Author

[Your Name/Organization]

